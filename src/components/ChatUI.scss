/* File: src/components/ChatUI.scss */
/* Berisi style untuk SEMUA 3 komponen UI chat baru */

// Variabel untuk konsistensi
$chat-background: #1e1f20;
$bubble-background: #2a2b2e;
$text-primary: #e8eaed;
$text-secondary: #999;
$accent-blue: #8ab4f8;
$border-color: #3c4043;
$bubble-radius: 28px;
$component-radius: 12px;

// 1. Toggle Sidebar (GENIUS BUBBLE Tab)
.chat-toggle-sidebar {
  position: fixed;
  top: 50%;
  right: 0; // Mulai dari kanan
  transform: translateY(-50%);
  z-index: 1000;
  display: flex;
  align-items: center;
  cursor: pointer;

  span {
    color: $text-secondary;
    font-size: 0.9rem;
    font-weight: 500;
    margin-right: 10px;
  }

  .tab {
    background: $chat-background;
    color: $text-primary;
    font-weight: bold;
    padding: 20px 10px;
    border-radius: $component-radius 0 0 $component-radius;
    writing-mode: vertical-rl; // Teks vertikal
    text-orientation: mixed;
    box-shadow: -5px 0px 15px rgba(0, 0, 0, 0.2);
    border: 1px solid $border-color;
    border-right: none;
  }
}

// 2. Speech Bubble (Jendela Chat Utama)
.speech-bubble-window {
  position: fixed;
  // top: 100px; // Jarak dari atas
  // left: 50%;
  transform: translateX(-50%);
  width: 90%;
  max-width: 700px;
  height: calc(
    100vh - 300px
  ); // Tinggi dinamis (sisakan 300px untuk input & ruang)
  min-height: 400px;
  z-index: 1001; // Di atas segalanya

  background: $chat-background;
  border: 1px solid $border-color;
  border-radius: $component-radius;
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
  display: flex;
  flex-direction: column;

  .window-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 8px 12px;
    border-bottom: 1px solid $border-color;
    flex-shrink: 0; // Header tidak boleh 'shrink'
  }

  // Toggle Model (Source)
  .model-toggle {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.8rem;
    font-weight: 600;
    color: $text-secondary;
    background: $bubble-background;
    padding: 6px 10px;
    border-radius: 20px;

    span:first-child {
      // Panah >>
      color: $accent-blue;
    }
  }

  // Tombol Tutup Sesi (Merah)
  .close-chat-button {
    background: #d93025; // Merah
    color: white;
    border: none;
    border-radius: 50%;
    width: 28px;
    height: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    cursor: pointer;
    &:hover {
      background: #c5221f;
    }
  }

  // Area Riwayat Chat
  .chat-history-area {
    flex-grow: 1;
    overflow-y: auto; // Scrollable
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  // Item Pesan Individual
  .message-item {
    width: 100%;

    .message-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;

      // Nama ("User" atau "Genius Bubble")
      span {
        font-weight: bold;
        color: $text-primary;
        font-size: 0.95rem;
      }

      // Kontrol (Edit, Copy)
      .message-controls {
        display: flex;
        gap: 8px;
        button {
          background: transparent;
          border: none;
          color: $text-secondary;
          cursor: pointer;
          font-size: 0.9rem;
          &:hover {
            color: $text-primary;
          }
        }
      }
    }

    // Bubble teks
    .message-body {
      background: $bubble-background;
      color: $text-secondary;
      padding: 12px 18px;
      border-radius: $component-radius;
      font-size: 0.95rem;
      line-height: 1.6;

      // Rendering Markdown (sesuai permintaan "Word/Doc")
      p,
      ol,
      ul {
        margin-top: 0;
        margin-bottom: 1em;
        &:last-child {
          margin-bottom: 0;
        }
      }
      strong {
        color: $text-primary;
      } // Bold
      em {
        font-style: italic;
      } // Italic
      ul,
      ol {
        padding-left: 20px;
      } // Lists
    }

    // Style untuk pesan AI (Genius Bubble)
    &.ai-message {
      .message-header span {
        color: $accent-blue;
      }
      .message-body {
        background: $chat-background; // Latar belakang AI lebih gelap
      }
    }
  }

  // === Tampilan Kode (Sesuai Permintaan Anda) ===
  .code-block-wrapper {
    position: relative;
    margin: 15px 0;

    // Ini adalah 'pre' tag dari react-syntax-highlighter
    pre {
      border-radius: 8px !important; // Paksa radius
      padding: 15px !important; // Paksa padding
      font-size: 0.85rem;
      // Aktifkan word-wrap untuk kode yang panjang
      white-space: pre-wrap !important;
      word-break: break-all !important;
    }

    // Tombol Copy Khusus Kode
    .code-copy-button {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(50, 50, 50, 0.7);
      color: $text-secondary;
      border: 1px solid $border-color;
      border-radius: 6px;
      padding: 5px 8px;
      font-size: 0.8rem;
      cursor: pointer;
      opacity: 0.3;
      transition: opacity 0.2s;

      &:hover {
        opacity: 1;
        background: rgba(70, 70, 70, 0.9);
      }
    }

    &:hover .code-copy-button {
      opacity: 1;
    }
  }
}

// 3. Gelembung Input User (Panel Bawah)
.user-input-bubble {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);

  width: 90%;
  max-width: 700px;

  background-color: $chat-background;
  border: 1px solid $border-color;
  border-radius: $bubble-radius;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
  z-index: 1002;

  display: flex;
  flex-direction: column;
  padding: 12px 12px 12px 20px;

  // Tombol Expand
  .expand-textarea-button {
    position: absolute;
    top: 10px;
    right: 10px;
    background: transparent;
    border: none;
    color: $text-secondary;
    cursor: pointer;
    font-size: 1.1rem;
    padding: 4px;
    border-radius: 50%;
    z-index: 10;
    &:hover {
      background-color: $bubble-background;
    }
  }

  // Baris Task Toggles
  .task-toggles {
    display: flex;
    gap: 8px;
    margin-bottom: 12px;
    overflow-x: auto; // Agar bisa di-scroll di HP
    padding-bottom: 5px; // Ruang untuk scrollbar

    .task-toggle {
      background: transparent;
      border: 1px solid $border-color;
      color: $text-secondary;
      border-radius: 15px;
      padding: 6px 12px;
      font-size: 0.8rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap; // Agar teks tidak terpotong

      &.active {
        // Saat aktif
        background: $accent-blue;
        color: $chat-background;
        border-color: $accent-blue;
      }
      &:hover:not(.active) {
        background: $bubble-background;
        border-color: $text-secondary;
      }
    }

    // Kontainer untuk "Other" (agar menu 'absolute' terhadapnya)
    .task-toggle-other {
      position: relative;

      // Menu dropdown "Other"
      .other-menu {
        position: absolute;
        bottom: 110%; // Muncul TEPAT DI ATAS tombol
        left: 0;
        background-color: $bubble-background;
        border-radius: $component-radius;
        padding: 5px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        display: flex;
        flex-direction: column;
        gap: 3px;
        min-width: 150px;
        z-index: 1001;

        button {
          background: transparent;
          border: none;
          color: $text-primary;
          padding: 8px 12px;
          text-align: left;
          border-radius: 6px;
          cursor: pointer;
          font-size: 0.9rem;
          &:hover {
            background-color: #444;
          }
        }
      }
    }
  }

  // Area Input Bawah
  .input-area {
    display: flex;
    align-items: flex-end; // Tombol sejajar di bawah
    gap: 10px;
  }

  // Tombol Upload
  .upload-button {
    background: $bubble-background;
    color: $text-secondary;
    border: none;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    cursor: pointer;
    flex-shrink: 0;
    &:hover {
      background-color: #3c4043;
    }
  }

  // Text Area
  textarea {
    flex-grow: 1;
    background: transparent;
    border: none;
    color: $text-primary;
    font-size: 1.1rem;
    line-height: 1.5;
    outline: none;
    box-shadow: none;
    resize: none;
    overflow-y: auto;
    padding-top: 10px; // Agar sejajar dengan tombol
  }

  // Tombol Kirim (Pesawat Kertas)
  .send-button {
    background: transparent;
    color: $text-secondary; // Warna 'disabled'
    border: none;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    cursor: not-allowed;
    flex-shrink: 0;
    transition: all 0.2s;

    &.active {
      // Saat aktif (sesuai permintaan Anda)
      background: $accent-blue;
      color: $chat-background;
      cursor: pointer;
      &:hover {
        background: #a6c9f8;
      }
    }
  }
}
